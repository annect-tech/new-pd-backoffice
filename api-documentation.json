{
  "apiBaseUrl": "http://186.248.135.172:31535",
  "auth": {
    "login": {
      "endpoint": "/auth/login",
      "method": "POST",
      "requiredFields": ["credential", "password"],
      "preferredFieldName": "credential",
      "acceptedCredentialTypes": ["email", "cpf", "username"],
      "explanation": "O campo 'credential' aceita email, CPF ou username. O backend busca o usuário usando OR entre esses três campos. Use 'credential' ao invés de 'email'.",
      "sampleSuccessResponse": {
        "status": 200,
        "body": {
          "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
          "refreshToken": "uuid-v4-token-string"
        }
      },
      "sampleFailureResponses": [
        {
          "status": 400,
          "body": {
            "message": "credential é obrigatório",
            "statusCode": 400
          },
          "meaning": "Campo credential não foi enviado ou está vazio"
        },
        {
          "status": 400,
          "body": {
            "message": "credential deve ser uma string",
            "statusCode": 400
          },
          "meaning": "Campo credential não é uma string válida"
        },
        {
          "status": 400,
          "body": {
            "message": "password é obrigatório",
            "statusCode": 400
          },
          "meaning": "Campo password não foi enviado ou está vazio"
        },
        {
          "status": 400,
          "body": {
            "message": "Credenciais inválidas.",
            "statusCode": 400
          },
          "meaning": "Usuário não encontrado ou senha incorreta"
        },
        {
          "status": 403,
          "body": {
            "message": "A sua conta foi suspensa. Entre em contato com a administração para mais detalhes.",
            "statusCode": 403
          },
          "meaning": "Conta do usuário está inativa (is_active = false)"
        },
        {
          "status": 403,
          "body": {
            "message": "Acesso negado.",
            "statusCode": 403
          },
          "meaning": "Usuário não possui roles associadas (user_roles está vazio ou null)"
        }
      ],
      "curlExampleSuccess": "curl -X POST http://186.248.135.172:31535/auth/login -H 'Content-Type: application/json' -d '{\"credential\":\"luke@pectecbh.com.br\",\"password\":\"qweasd32\"}'",
      "notes": "O campo 'credential' é automaticamente trimado pelo backend. Pode ser email, CPF (com ou sem formatação) ou username. O backend faz busca case-sensitive nos campos email, cpf e username."
    },
    "register": {
      "endpoint": null,
      "method": null,
      "available": false,
      "expectedPayload": null,
      "notes": "Não existe endpoint público de registro. Apenas administradores podem criar usuários através do endpoint POST /admin/users (requer autenticação Bearer token e role ADMIN ou ADMIN_MASTER)."
    },
    "refreshToken": {
      "endpoint": "/auth/refresh-token",
      "method": "POST",
      "payloadShape": {
        "refreshToken": "string"
      },
      "responseShape": {
        "accessToken": "string",
        "refreshToken": "string"
      },
      "sampleSuccessResponse": {
        "status": 200,
        "body": {
          "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
          "refreshToken": "new-uuid-v4-token-string"
        }
      },
      "sampleFailureResponses": [
        {
          "status": 400,
          "body": {
            "message": "refreshToken é obrigatório",
            "statusCode": 400
          },
          "meaning": "Campo refreshToken não foi enviado"
        },
        {
          "status": 400,
          "body": {
            "message": "Refresh token inválido.",
            "statusCode": 400
          },
          "meaning": "Refresh token não existe no banco de dados"
        },
        {
          "status": 400,
          "body": {
            "message": "Refresh token expirado.",
            "statusCode": 400
          },
          "meaning": "Refresh token expirou (expiresAt < data atual)"
        },
        {
          "status": 404,
          "body": {
            "message": "Usuário não encontrado.",
            "statusCode": 404
          },
          "meaning": "Usuário associado ao refresh token não existe mais"
        }
      ],
      "curlExampleSuccess": "curl -X POST http://186.248.135.172:31535/auth/refresh-token -H 'Content-Type: application/json' -d '{\"refreshToken\":\"your-refresh-token-here\"}'",
      "notes": "Após usar um refresh token, ele é automaticamente removido e um novo é gerado. O token antigo não pode ser reutilizado."
    },
    "logout": {
      "endpoint": null,
      "method": null,
      "notes": "Não existe endpoint explícito de logout. O logout deve ser feito no frontend removendo os tokens do storage. Para invalidar o refresh token no backend, seria necessário deletá-lo manualmente (não há endpoint público para isso)."
    },
    "tokenNames": {
      "accessTokenField": "accessToken",
      "refreshTokenField": "refreshToken"
    }
  },
  "profile": {
    "getMyProfileEndpoint": null,
    "method": null,
    "requiresAuthHeader": null,
    "sampleSuccessResponse": null,
    "notes": "Não existe endpoint específico para obter o perfil do usuário atual (ex: /user/user-profiles/me). Para obter o perfil do usuário logado: 1) Extrair o 'sub' (user id) do payload do JWT accessToken, 2) Buscar o perfil através do endpoint GET /admin/user-profiles (lista todos os perfis) e filtrar pelo user_id no frontend, ou criar um endpoint customizado. O perfil está relacionado ao auth_user através do campo user_id na tabela user_profile_userprofile."
  },
  "testUsers": [
    {
      "identifier": "luke@pectecbh.com.br",
      "valid": true,
      "credentialToUse": "luke@pectecbh.com.br",
      "password": "qweasd32",
      "notes": "Usuário de teste mencionado. Se retornar 'Credenciais inválidas', verificar se: 1) O usuário existe no banco, 2) A senha está correta, 3) O usuário está ativo (is_active = true), 4) O usuário possui roles associadas (user_roles não está vazio)."
    }
  ],
  "protectedEndpointsExamples": [
    {
      "endpoint": "/admin/user-profiles",
      "method": "GET",
      "requiredRole": "ADMIN ou ADMIN_MASTER",
      "sampleCurl": "curl -X GET 'http://186.248.135.172:31535/admin/user-profiles?page=1&size=10' -H 'Authorization: Bearer {ACCESS_TOKEN}' -H 'Content-Type: application/json'",
      "sampleResponse": {
        "data": [
          {
            "id": "1",
            "user_id": 123,
            "cpf": "12345678900",
            "personal_email": "user@example.com",
            "bio": "Bio do usuário",
            "occupation": "Cargo",
            "department": "Departamento",
            "work_location": "Localização",
            "manager": "Gerente",
            "profile_photo": "https://s3.../photo.jpg",
            "birth_date": "1990-01-01T00:00:00.000Z",
            "hire_date": "2020-01-01T00:00:00.000Z"
          }
        ],
        "meta": {
          "page": 1,
          "size": 10,
          "total": 1,
          "totalPages": 1
        }
      },
      "notes": "Retorna lista paginada de todos os perfis de usuários. Requer autenticação Bearer token e role ADMIN ou ADMIN_MASTER. Query params: page (número), size (número)."
    },
    {
      "endpoint": "/admin/users",
      "method": "GET",
      "requiredRole": "ADMIN ou ADMIN_MASTER",
      "sampleCurl": "curl -X GET 'http://186.248.135.172:31535/admin/users?page=1&size=10' -H 'Authorization: Bearer {ACCESS_TOKEN}' -H 'Content-Type: application/json'",
      "sampleResponse": {
        "data": [
          {
            "id": 123,
            "username": "luke",
            "email": "luke@pectecbh.com.br"
          }
        ],
        "meta": {
          "page": 1,
          "size": 10,
          "total": 1,
          "totalPages": 1
        }
      },
      "notes": "Lista usuários do tenant do admin logado. Requer autenticação Bearer token e role ADMIN ou ADMIN_MASTER. Query params: page, size."
    },
    {
      "endpoint": "/user/users",
      "method": "GET",
      "requiredRole": "qualquer role autenticada",
      "sampleCurl": "curl -X GET 'http://186.248.135.172:31535/user/users?page=1&size=10' -H 'Authorization: Bearer {ACCESS_TOKEN}' -H 'Content-Type: application/json'",
      "sampleResponse": {
        "data": [
          {
            "id": 123,
            "username": "luke",
            "email": "luke@pectecbh.com.br"
          }
        ],
        "meta": {
          "page": 1,
          "size": 10,
          "total": 1,
          "totalPages": 1
        }
      },
      "notes": "Lista usuários do tenant do usuário logado. Requer apenas autenticação Bearer token (qualquer role). Query params: page, size."
    }
  ],
  "errorsAndMessages": {
    "credential_is_required": "credential é obrigatório",
    "credential_must_be_string": "credential deve ser uma string",
    "password_is_required": "password é obrigatório",
    "password_must_be_string": "password deve ser uma string",
    "invalid_credentials": "Credenciais inválidas.",
    "inactive_account": "A sua conta foi suspensa. Entre em contato com a administração para mais detalhes.",
    "forbidden_account": "Acesso negado.",
    "refresh_token_invalid": "Refresh token inválido.",
    "refresh_token_expired": "Refresh token expirado.",
    "user_not_found": "Usuário não encontrado.",
    "other_common_errors": [
      "Todos os campos de validação seguem o padrão: '{campo} é obrigatório' ou '{campo} deve ser uma string' (ou outro tipo conforme validação).",
      "Erros de validação retornam status 400 com formato: { message: string, statusCode: number }",
      "Erros de autenticação/autorização retornam status 401/403 com formato: { message: string, statusCode: number }"
    ]
  },
  "recommendationForFrontend": {
    "loginStrategy": "Sempre usar o campo 'credential' ao invés de 'email'. O frontend pode aceitar email, CPF ou username do usuário e enviar como 'credential'. Exemplo de payload: { \"credential\": \"luke@pectecbh.com.br\", \"password\": \"qweasd32\" }. O backend automaticamente busca em email, cpf ou username.",
    "registerUi": "hide",
    "registerUiExplanation": "Não exibir UI de registro público. Apenas administradores podem criar usuários através do endpoint POST /admin/users (requer autenticação e role ADMIN ou ADMIN_MASTER). Se necessário criar usuários, redirecionar para área administrativa ou criar um fluxo de convite por email.",
    "profileFetching": "Não existe endpoint direto para obter o perfil do usuário atual. Opções: 1) Extrair o user_id do payload do JWT (campo 'sub'), 2) Buscar o perfil através de GET /admin/user-profiles filtrando pelo user_id no frontend, 3) Criar um novo endpoint no backend GET /user/user-profiles/me que retorne o perfil do usuário logado (recomendado para melhor UX). O payload do JWT contém: { sub: number (user_id), roles: string[], tenant_city_id: string }."
  },
  "jwtPayloadStructure": {
    "sub": "number (user_id do auth_user)",
    "roles": "string[] (array de nomes de roles, ex: ['ADMIN', 'USER'])",
    "tenant_city_id": "string (ID da cidade/tenant do usuário)"
  },
  "authenticationHeader": {
    "format": "Bearer {accessToken}",
    "example": "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}

